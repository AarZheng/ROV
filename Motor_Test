import RPi.GPIO as GPIO
import time

# Pin Definitions
IN1 = 23     # Direction pin 1
IN2 = 24     # Direction pin 2
ENA = 25     # Enable pin (PWM)

# Setup
GPIO.setmode(GPIO.BCM)
GPIO.setup(IN1, GPIO.OUT)
GPIO.setup(IN2, GPIO.OUT)
GPIO.setup(ENA, GPIO.OUT)

# Set up PWM on ENA pin at 1000Hz
pwm = GPIO.PWM(ENA, 1000)
pwm.start(0)  # Start with motor off

def motor_forward(speed_percent):
    GPIO.output(IN1, GPIO.HIGH)
    GPIO.output(IN2, GPIO.LOW)
    pwm.ChangeDutyCycle(speed_percent)

def motor_backward(speed_percent):
    GPIO.output(IN1, GPIO.LOW)
    GPIO.output(IN2, GPIO.HIGH)
    pwm.ChangeDutyCycle(speed_percent)

def motor_stop():
    pwm.ChangeDutyCycle(0)
    GPIO.output(IN1, GPIO.LOW)
    GPIO.output(IN2, GPIO.LOW)

try:
    while True:
        print("Forward at 50%")
        motor_forward(50)
        time.sleep(2)

        print("Backward at 75%")
        motor_backward(75)
        time.sleep(2)

        print("Stop")
        motor_stop()
        time.sleep(2)

except KeyboardInterrupt:
    print("Program stopped by user")

finally:
    pwm.stop()
    GPIO.cleanup()
